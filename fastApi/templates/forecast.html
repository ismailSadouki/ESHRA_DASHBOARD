<!DOCTYPE html>
<html>
<head>
    <title>Energy Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h2>ðŸ”‹ Utility Consumption Forecast</h2>

    <label for="building-select">Choose Building(s):</label>
    <select id="building-select" multiple>
        {% for b in building_ids %}
        <option value="{{ b }}">{{ b }}</option>
        {% endfor %}
    </select>
    <button onclick="loadDashboard()">Apply</button>

    <div id="forecast" style="margin-top:20px;"></div>

    <script>
        async function loadDashboard() {
            const select = document.getElementById("building-select");
            const ids = Array.from(select.selectedOptions).map(o => o.value).join(",");
            const res = await fetch(`/api/forecast?building_ids=${ids}`);
            const data = await res.json();

            const trace = {
                x: data.map(d => d.ds),
                y: data.map(d => d.yhat),
                mode: 'lines+markers',
                name: 'Forecast'
            };
            Plotly.newPlot('forecast', [trace], { title: "30-Day Forecast" });
        }

        loadDashboard();  // Load default forecast
    </script>
</body>
</html>

